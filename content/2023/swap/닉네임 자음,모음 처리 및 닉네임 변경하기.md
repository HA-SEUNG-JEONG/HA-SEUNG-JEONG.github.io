---
emoji: 🔮
title: 닉네임 자음,모음 처리 및 닉네임 변경하기
date: '2023-02-01 00:00:00'
author: 정하승
tags: 블로그 github-pages gatsby
categories: swap
---

닉네임 변경 및 초성에 대한 에러 처리를 위해 다음과 같은 코드 작업을 했다.

코드가 더 길긴 한데 필요한 부분만 가져왔다.

```tsx
interface NickNameProps {
  nickName: string;
}

const Profile = () => {
  const [isOpen, setIsOpen] = useRecoilState(profileImage);
  const userObj = sessionUserData();
  const [nickName, setNickName] = useState(userObj.displayName);

  const {
    register,
    handleSubmit,
    formState: { errors, isSubmitted },
    setValue,
  } = useForm<NickNameProps>({ mode: 'onChange' }); // mode: 'onChange' => 사용자에게 실시간으로 피드백 제공

  const onValid = async ({ nickName }: NickNameProps) => {
    const auth = getAuth(); // 인증 정보 가져오기
    if (auth.currentUser) { // auth에 현재 유저 정보가 있을 때 새로 입력한 닉네임을 displayName으로 설정
      await updateProfile(auth.currentUser, {
        displayName: nickName,
      });
      setNickName(nickName); // 닉네임 업데이트
    }
  };

  const onChange = (event: ChangeEvent<HTMLInputElement>) => {
    const {
      target: { value },
    } = event;

    //setNickName 함수 호출로 입력한 값을 업데이트한 다음에
    //setValue 함수를 통해서 nickName 필드에 대한 값을 집어넣어야 한다.
    setNickName(value);
    setValue('nickName', value);
  };

  const handleIconClick = () => {
    setIsOpen((current) => !current);
  };

  return (
    <SwapContainer>
      <SideBar />
      <MainContainer>
        <ProfileContainer>
        <InputContainer>
          <Form onSubmit={handleSubmit(onValid)}>
            <Label htmlFor="nickname">닉네임</Label>
            <StyleContainer>
              <input
                type="text"
                {...register('nickName', {
                  required: true,
                  minLength: 2,
                  maxLength: 5,
                  pattern: /([0-9a-zA-Z가-힣\x20])/i, //초성 미포함
                })}
              />
              /*input 태그에 있는 pattern과 errors.nickName?.type이 pattern인지 maxLength 인지 등등을 확인시켜주는 장치가 따로 마련되어있다.*/
              {errors.nickName?.type === 'pattern' ? (
                <ErrorMessage>초성은 불가능합니다.</ErrorMessage>
              ) : null}
              <Button type="submit">수정</Button>
            </StyleContainer>
          </Form>
        </InputContainer>
      </MainContainer>
    </SwapContainer>
  );
};

```

닉네임 초성 처리를 하면서 조금 삽질을 한 거 같다...

```tsx
errors.nickName?.type === 'pattern';
```

이렇게 `type`이라는 친구는 사실 사용해 본 적이 거의 없고 항상 `errors.nickname.message` 형태로만 사용해본 터라 조금 익숙치 않은 것도 있었다.

지금 이 글을 쓰는 이유도 기록해두기 위해서다.

그리고 좋았던 점은

```tsx
errors.nickName?.type;
```

이 어떤 ValidatioRule(문서에 이렇게 나와있다.)인지(maxLength,minLength,pattern 등등) 확인을 시켜주기 때문에 자동완성도 되고 편리하다.

그리고 자음,모음에 대한 처리도 조금 애를 먹었는데 정규식 테스트 사이트에서 직접 테스트를 해보니까 익숙해지는 거 같다.

```tsx
/([0-9a-zA-Z가-힣\x20])/i;
```

위와 같이 pattern을 명시하면 자음,모음으로 구성된 닉네임은 사용이 불가능하다고 메시지를 띄워줄 수 있다.
